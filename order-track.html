<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SmartShop â€“ Order Tracking</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode:'class',
      theme:{
        extend:{
          fontFamily:{ inter:['Inter','ui-sans-serif','system-ui'] },
          boxShadow:{ soft:'0 8px 24px rgba(0,0,0,.08)' }
        }
      }
    }
  </script>

  <!-- Font Awesome -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
        crossorigin="anonymous" referrerpolicy="no-referrer"/>
  <link rel="icon" href="./logo.jpg"/>
</head>

<body class="font-inter bg-gradient-to-br from-amber-50 via-white to-blue-50 dark:from-gray-950 dark:via-gray-900 dark:to-gray-950 text-gray-800 dark:text-gray-100 min-h-screen flex flex-col">

  <!-- HEADER -->
  <header class="border-b bg-white/80 backdrop-blur dark:bg-gray-950/80 sticky top-0 z-50">
    <nav class="max-w-7xl mx-auto px-4 sm:px-6 h-16 flex items-center justify-between">
      <a href="./index.html" class="flex items-center gap-3">
        <img src="./logo.jpg" class="h-10 w-auto object-contain" alt="SmartShop">
        <span class="font-[Playfair_Display] text-xl">SmartShop</span>
      </a>
      <a href="./index.html"
         class="px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-medium shadow-md hover:from-blue-700 hover:to-indigo-700 transition">
         <i class="fa-solid fa-house me-2"></i>Home
      </a>
    </nav>
  </header>

  <!-- HERO -->
  <section class="relative py-14 text-center text-white bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 shadow-inner">
    <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1581092795360-fd1ca03fe0eb?q=80&w=1600&auto=format&fit=crop')] bg-cover bg-center opacity-20"></div>
    <div class="relative z-10 max-w-2xl mx-auto px-4">
      <h1 class="text-4xl font-extrabold mb-2">Track Your Order</h1>
      <p class="opacity-90 mb-6">Enter your order ID below to check delivery progress in real time.</p>
      <div class="flex flex-col sm:flex-row items-center justify-center gap-3">
        <input id="orderInput" type="text" placeholder="Enter order ID"
               class="w-full sm:w-80 rounded-xl border px-4 py-2 text-gray-800 focus:outline-none focus:ring-2 focus:ring-amber-400">
        <button id="trackBtn"
                class="px-6 py-2 rounded-xl bg-white text-blue-700 font-semibold shadow hover:bg-blue-50 transition">
          <i class="fa-solid fa-magnifying-glass"></i> Track
        </button>
      </div>
    </div>
  </section>

  <!-- MAIN TRACKING CARD -->
  <main class="flex-1 max-w-5xl mx-auto px-4 sm:px-6 py-10">
    <div id="trackingCard" class="hidden rounded-3xl border bg-white dark:bg-gray-900 shadow-soft p-8 transition-all duration-500">
      <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
        <i class="fa-solid fa-box text-blue-600"></i> Order Status
      </h2>

      <div class="space-y-6">
        <!-- Timeline -->
        <div class="relative border-l-2 border-gray-300 dark:border-gray-700 ml-6">
          <template id="statusTemplate">
            <div class="pl-6 pb-6 relative">
              <div class="absolute -left-[11px] top-[3px] w-5 h-5 rounded-full bg-gray-300 dark:bg-gray-700 border-2 border-white flex items-center justify-center">
                <i class="fa-solid fa-circle-check text-white text-xs hidden"></i>
              </div>
              <div class="font-semibold mb-1"></div>
              <div class="text-sm opacity-70"></div>
            </div>
          </template>
          <div id="timeline"></div>
        </div>

        <!-- Delivery Info -->
        <div id="deliveryInfo" class="mt-6 hidden border-t pt-4 text-sm">
          <p><i class="fa-solid fa-truck-fast text-blue-600 me-2"></i>
             Expected Delivery: <span id="deliveryDate" class="font-semibold"></span>
          </p>
          <p><i class="fa-solid fa-location-dot text-blue-600 me-2"></i>
             Destination: <span id="destination" class="font-semibold"></span>
          </p>
        </div>
      </div>
    </div>
  </main>

  <!-- FOOTER -->
  <footer class="border-t py-6 text-center text-sm text-gray-600 dark:text-gray-400">
    Â© <span id="year"></span> SmartShop â€¢ All Rights Reserved
  </footer>

  <script>
  document.getElementById("year").textContent = new Date().getFullYear();

  const trackBtn = document.getElementById("trackBtn");
  const input = document.getElementById("orderInput");
  const card = document.getElementById("trackingCard");
  const timeline = document.getElementById("timeline");
  const deliveryInfo = document.getElementById("deliveryInfo");
  const deliveryDate = document.getElementById("deliveryDate");
  const destination = document.getElementById("destination");

  // Demo sample orders
  const sampleOrders = {
    "ORD12345": {
      destination: "Dhaka, Bangladesh",
      deliveryDate: "Nov 6, 2025",
      status: [
        { stage: "Order Confirmed", desc: "Your order has been placed successfully.", done: true },
        { stage: "Packaging", desc: "Items are being packed for shipment.", done: true },
        { stage: "Shipping", desc: "Package is in transit with the courier.", done: true },
        { stage: "Delivered", desc: "Your order was delivered successfully!", done: false }
      ]
    },
    "ORD98765": {
      destination: "Beijing, China",
      deliveryDate: "Nov 10, 2025",
      status: [
        { stage: "Order Confirmed", desc: "Order received.", done: true },
        { stage: "Packaging", desc: "Items being packaged.", done: false },
        { stage: "Shipping", desc: "Awaiting pickup by courier.", done: false },
        { stage: "Delivered", desc: "Will be delivered soon.", done: false }
      ]
    }
  };

  // ðŸ”¹ Merge real orders saved from checkout with sampleOrders
  function getAllOrdersMap() {
    const map = { ...sampleOrders };
    const saved = JSON.parse(localStorage.getItem('smartshop-orders') || '[]');
    saved.forEach(o => { map[o.id] = { destination:o.destination, deliveryDate:o.deliveryDate, status:o.status }; });
    return map;
  }

  // normalize input (remove dots/spaces etc.)
  const norm = s => (s || '').toUpperCase().replace(/[^A-Z0-9]/g, '');

  function handleTrack(idRaw){
    const id = norm(idRaw);
    const orders = getAllOrdersMap();
    const order = orders[id];
    if (!order) {
      card.classList.add("hidden");
      alert("No order found for ID: " + id);
      return;
    }

    timeline.innerHTML = "";
    const template = document.getElementById("statusTemplate");
    order.status.forEach(step => {
      const node = template.content.cloneNode(true);
      const dot = node.querySelector("div > div");
      const check = dot.querySelector("i");
      const stageEl = node.querySelector(".font-semibold");
      const descEl = node.querySelector(".text-sm");
      stageEl.textContent = step.stage;
      descEl.textContent = step.desc;
      if (step.done) { dot.classList.replace("bg-gray-300", "bg-green-500"); check.classList.remove("hidden"); }
      timeline.appendChild(node);
    });

    deliveryDate.textContent = order.deliveryDate;
    destination.textContent = order.destination;
    deliveryInfo.classList.remove("hidden");
    card.classList.remove("hidden");
    card.scrollIntoView({ behavior: "smooth" });
  }

  // Track button click
  trackBtn.addEventListener("click", () => handleTrack(input.value));

  // Prefill the last created order ID (optional)
  const last = localStorage.getItem('smartshop-lastOrderId');
  if (last) { input.value = last; }
</script>

</body>
</html>
